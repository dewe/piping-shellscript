#!/bin/sh
set -eu

usage() {
    cat >&2 << 'EOF'
Usage: trim [options]

Remove leading and trailing whitespace from each line on stdin

Options:
  -h, --help    Show this help message

Examples:
  echo '  hello  ' | trim
  trim < input.txt
EOF
}

trim_line() {
    printf '%s\n' "$1" | sed 's/^[[:space:]]*//; s/[[:space:]]*$//'
}

main() {
    # Check for help flags
    if [ $# -gt 0 ]; then
        case "$1" in
            -h|--help)
                usage
                exit 0
                ;;
        esac
    fi

    # Validate input source
    if [ -t 0 ]; then
        usage
        exit 1
    fi

    # Check if there's any input
    if ! IFS= read -r first_line; then
        usage
        exit 1
    fi

    trim_line "$first_line"

    while IFS= read -r line || [ -n "$line" ]; do
        trim_line "$line"
    done
}

main "$@"

